# 等待模式使用指南

## 什么是等待模式？

等待模式是虚拟摄像头的一个新特性，允许你：
1. **先启动虚拟摄像头** - 显示待机画面
2. **在应用中选择摄像头** - 其他人看到的是待机画面
3. **准备好后再播放** - 手动触发开始播放视频

## 为什么需要等待模式？

### 问题场景
使用旧版本（立即播放模式）时：
```
1. 启动程序 → 视频立即开始播放
2. 打开Zoom → 选择虚拟摄像头
3. 问题：视频已经播放了一半！
```

### 解决方案
使用等待模式：
```
1. 启动程序 → 显示待机画面 ✓
2. 打开Zoom → 选择虚拟摄像头 → 看到待机画面 ✓
3. 准备好后 → 按Enter → 从头开始播放 ✓
```

## 使用方法

### 命令行版本

#### 方式1：等待模式（默认）

```bash
python virtual_camera.py video.mp4
```

**操作步骤：**
1. 运行命令后，虚拟摄像头启动
2. 会显示黑色背景的待机画面，上面写着：
   ```
   虚拟摄像头已就绪
   等待开始播放...
   按 Enter 开始播放 | Ctrl+C 退出
   ```
3. 此时可以：
   - 打开Zoom/Teams等应用
   - 选择"OBS Virtual Camera"
   - 调整窗口位置
   - 测试音频、网络等
4. 一切就绪后，在命令行窗口按 **Enter键**
5. 视频开始播放

#### 方式2：立即播放模式

如果你想要旧的行为（立即播放）：

```bash
python virtual_camera.py video.mp4 --no-wait
```

### GUI版本

GUI版本默认使用等待模式：

1. **启动GUI**
   ```bash
   python virtual_camera_gui.py
   ```

2. **选择视频文件**
   - 点击"选择视频"按钮
   - 选择你要播放的视频

3. **启动虚拟摄像头**
   - 点击"启动虚拟摄像头"按钮
   - 此时会显示待机画面

4. **准备应用程序**
   - 打开Zoom/Teams等应用
   - 选择"OBS Virtual Camera"
   - 此时会议中会看到待机画面

5. **开始播放**
   - 准备好后，点击GUI中的"开始播放"按钮
   - 视频开始播放

## 待机画面说明

待机画面显示内容：
```
┌─────────────────────────────────────┐
│                                     │
│                                     │
│      虚拟摄像头已就绪                │
│      等待开始播放...                 │
│                                     │
│                                     │
│  按 Enter 开始播放 | Ctrl+C 退出     │
└─────────────────────────────────────┘
```

特点：
- 深灰色背景（不刺眼）
- 白色大字标题
- 清晰的操作提示
- 专业的视觉效果

## 实际应用场景

### 场景1：线上会议演讲

**不使用等待模式（问题）：**
```
8:00 AM - 启动虚拟摄像头，视频开始播放
8:02 AM - 进入Zoom会议室
8:03 AM - 选择虚拟摄像头
❌ 问题：视频已经播放3分钟了！
```

**使用等待模式（解决）：**
```
8:00 AM - 启动虚拟摄像头，显示待机画面
8:02 AM - 进入Zoom会议室
8:03 AM - 选择虚拟摄像头，看到待机画面 ✓
8:05 AM - 轮到我演讲，按Enter，从头播放 ✓
```

### 场景2：教学视频演示

```bash
# 1. 课前准备
python virtual_camera.py lesson01.mp4

# 2. 打开在线教室（Teams/Zoom）
#    学生看到：待机画面

# 3. 开始讲课
#    介绍今天的内容...

# 4. 准备播放视频时
#    按Enter键 → 视频开始播放
```

### 场景3：直播预热

```bash
# 1. 提前启动（直播前10分钟）
python virtual_camera.py promo_video.mp4

# 2. 打开直播软件
#    观众看到：待机画面

# 3. 直播正式开始时
#    按Enter → 播放宣传视频
```

## 常见问题

### Q1: 如何切换回立即播放模式？

**A:** 使用 `--no-wait` 参数：
```bash
python virtual_camera.py video.mp4 --no-wait
```

### Q2: 待机画面可以自定义吗？

**A:** 目前是固定的。未来版本可能支持自定义待机图片。

临时方案：修改代码中的 `create_standby_frame()` 函数。

### Q3: 如果忘记按Enter会怎样？

**A:** 虚拟摄像头会一直显示待机画面，直到你按Enter键。不会自动开始播放。

### Q4: 可以在播放中途暂停吗？

**A:** 目前不支持暂停。一旦开始播放，会一直循环播放直到你停止程序（Ctrl+C）。

### Q5: GUI版本按钮点不了？

**A:** 检查顺序：
1. 先点"启动虚拟摄像头" → "开始播放"按钮激活
2. 再点"开始播放" → 视频开始播放

### Q6: 命令行版本按Enter没反应？

**A:** 确保：
- 命令行窗口是激活状态（不是在后台）
- 按的是Enter键（不是空格或其他键）
- Windows用户：确保命令行窗口有焦点

## 技术细节

### 实现原理

**等待模式流程：**
```python
while True:
    if not playing:
        # 发送待机画面
        cam.send(standby_frame)
    else:
        # 读取视频帧
        frame = cap.read()
        cam.send(frame)
```

**待机画面生成：**
- 使用OpenCV创建黑色背景图像
- 使用cv2.putText()添加文字
- 实时生成，无需外部图片文件

### 性能影响

等待模式对性能的影响：
- **CPU占用：** 极低（待机画面是静态的）
- **内存占用：** 几乎无影响
- **启动时间：** 无影响

## 对比表格

| 特性 | 等待模式 | 立即播放模式 |
|------|---------|-------------|
| 默认行为 | ✅ 是 | ❌ 否 |
| 启动后行为 | 显示待机画面 | 立即播放视频 |
| 手动控制 | ✅ 支持 | ❌ 不支持 |
| 适合场景 | 会议、演讲、直播 | 测试、自动化 |
| 启用方式 | 默认 | `--no-wait` |

## 最佳实践

### ✅ 推荐做法

1. **提前启动**
   ```bash
   # 会议前5分钟启动
   python virtual_camera.py presentation.mp4
   ```

2. **先测试再播放**
   - 启动虚拟摄像头
   - 在应用中测试画面
   - 确认一切正常后再按Enter

3. **使用GUI版本**
   - 更直观
   - 不容易误操作
   - 有明确的按钮提示

### ❌ 不推荐做法

1. **启动后立即加入会议**
   - 可能还没准备好
   - 匆忙操作容易出错

2. **使用立即播放模式参加正式会议**
   - 无法控制播放时机
   - 可能错过视频开头

## 总结

等待模式让你能够：
- ✅ 从容准备
- ✅ 控制时机
- ✅ 避免尴尬
- ✅ 专业呈现

记住：**等待模式 = 启动后显示待机画面，手动触发播放**

祝你使用愉快！🎉

